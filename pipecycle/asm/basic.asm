# 基础测试程序 - MIPS五级流水线CPU
# 使用指令：add, addi, lw, sw, beq, j, andi
# 设计无冒险，5级流水线可顺序执行

.text
.globl main
main:
    # 1. 初始化寄存器
    addi $1, $0, 10       # $1 = 10
    
    # 2. 立即数运算
    addi $2, $0, 5        # $2 = 5
    
    # 3. R型指令运算
    add  $3, $1, $2       # $3 = 15 (10+5)
    
    # 4. 逻辑运算
    andi $4, $3, 7        # $4 = 15 & 7 = 7
    
    addi $6, $0, 1        # $6 = 1

    addi $7, $0, 2        # $7 = 2

    # 5. 存储数据到内存
    sw   $3, 0($0)        # mem[0] = 15
    
    # 6. 从内存加载数据
    lw   $5, 0($0)        # $5 = mem[0] = 15
    
    # 7. 分支测试（不跳转）
    beq  $3, $5, equal    # 15 == 15，应该跳转
    
    # 8. 这行不应该执行（因为分支跳转了）
    addi $6, $0, 99
    
equal:
    # 9. 跳转指令
    j    end
    
    # 10. 这行不应该执行（跳过了）
    addi $7, $0, 77
    
end:
    # 11. 最终结果
    addi $8, $0, 1        # $8 = 1（程序正常结束标志）
    
    # 结束循环
done:
    j    done             # 无限循环结束程序